package com.internousdev.template.dao;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

import com.internousdev.template.dto.MyPageDTO;
import com.internousdev.template.util.DBConnector;

public class MyPageDAO {

	public MyPageDTO getMyPageUserInfo(String item_transaction_id, String user_master_id)
	throws SQLException {
		DBConnector db = new DBConnector();
		Connection con=db.getConnection();
		MyPageDTO DTO=new MyPageDTO();

		String sql="SELECT iit.item_name,ubit.total_price,ubit.total_count,ubit_pay FROM user_buy_item_transaction ubit LEFT JOIN item_info transaction iit ON ubit.user_master_id=? ORDER BY ubit.insert_date DESC";

		try{
			PreparedStatement ps =con.prepareStatement(sql);
			ps.setString(1, item_transaction_id);
			ps.setString(2,user_masuter_id);
			ResultSet rs =ps.executeQuery();

			if(rs.next()){
				DTO.setItemName(rs.getString("item_name"));
				DTO.setTotalPrice(rs.getString("total_price"));
				DTO.setTotalCount(rs.getString("total_count"));
				DTO.setPayment(rs.getString("pay"));
			}
		}


	}
}
